# 计算机网络

## 体系结构

### OSI七层协议

分七层——支持异构网络的互联互通，自底向下依次为：

1. 物理层

   任务：透明地传输比特流

   功能：为数据段设备提供传送数据通路

   传输单位：比特

2. 数据链路层

   任务：将网络层传输下来的IP数据报组装成帧

   功能：

   1. 链路连接的建立、拆除和分离
   2. 帧定界和帧同步
   3. 差错检测

   传输单位：帧

3. 网络层

   任务：

   1. 将传输层传下来的报文封装成分组
   2. 选择合适的路由，使得传输层传下来的分组能够交付到目的主机

   功能：

   1. 为传输层提供服务
   2. 组包和拆包
   3. 路由选择
   4. 拥塞控制

4. 传输层

   任务：负责主机中两个进程间的通信

   功能：

   1. 为端到端连接提供可靠的服务
   2. 为端到端连接提供流量控制、差错控制、服务质量等管理服务

   传输单位：报文段（TCP）/用户数据报（UDP）

5. 会话层

   任务：不同主机上各进程的对话

6. 表示层

7. 应用层

   任务：提供系统与用户的接口

### UDP协议

* 特点：
  1. 无连接的：发送数据之前不需要建立连接
  2. 尽最大努力交付：不保证可靠交付（主机不需要维持复杂的连接状态表）
  3. 面向报文：发送/接收方的UDP对应用程序交下来的报文，在添加/去除首部后就向下交付IP层
  4. 没有拥塞控制
  5. 支持一对一、一对多、多对一、多对多
  6. 首部开销小

* 首部格式（最小8字节）：源端口 目的端口 长度 校验和

* 伪首部 用于 计算校验和

## 分隔

### 浏览器打开一个链接经历了哪些过程

1. DNS解析

   递归地向上查找URL对应的IP地址，顺序如下：

   1. 浏览器缓存

   2. 本地hosts文件

   3. 路由器缓存

   4. 本地（ISP互联网服务提供商，移动电信联通）DNS服务器

      看自己缓存里有没有

   5. DNS根服务器，这里开始是迭代

      跟服务器没有记录具体的域名和IP地址对应关系，而是告诉本地DNS服务器可以到某个域服务器查询（先顶级域，后主域）

   ![img](https://pic3.zhimg.com/80/v2-367da995706289a83af5c0372d55f43e_1440w.jpg)

2. 建立TCP连接

   三次握手

3. 发送HTTP请求

   以随机端口向服务器80端口发送TCP请求

4. 服务器处理并返回响应报文

5. 浏览器解析渲染页面

   > 1. 根据HTML解析出DOM树
   > 2. 根据CSS解析生成CSS规则树
   > 3. 结合DOM树和CSS规则树生成渲染树
   > 4. 根据渲染树计算每一个节点地的信息
   > 5. 根据计算好的信息绘制界面

6. 断开连接：TCP四次挥手

> 这里涉不涉及新HTTP协议的长连接

## 参考

- [经典面试题：从 URL 输入到页面展现到底发生什么？](https://blog.fundebug.com/2019/02/28/what-happens-from-url-to-webpage/)

- [面试官：浏览器输入URL后发生了什么？](https://juejin.cn/post/6871947938701475847)
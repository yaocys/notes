# TCP协议

## TCP协议

网络层为主机之间提供逻辑通信，而运输层为应用进程之间提供**端到端**的逻辑通信

### TCP协议

#### 三次握手，四次挥手

客户端有CLOSED、SYN-SEND、ESTABLISHED三种状态

服务器端有CLOSED、LISTEN、SYN-RCVD、ESTABLISHED四种状态

<img src="https://uploadfiles.nowcoder.com/images/20190828/8309948_1566974042905_FC5D1E4A8542CB51426DC924E8578CD5" alt="img" style="zoom:50%;" />

#### 流量控制

#### 拥塞控制

慢开始算法：初始值极小，但成倍增加

拥塞避免算法：线性增长

快重传&快恢复：解决因报文段丢失而导致发送端超时，误认为网络发生”拥塞“

### TCP协议

主要干什么？流量控制、拥塞控制、消息重传、滑动窗口

* 特点：

  1. 面向连接的：应用程序在使用TCP协议之前，必须先建立TCP连接；传送数据完毕后，必须释放已建立的连接

  2. 每一条TCP连接只能有两个**端点（套接字）**：

     **TCP连接 :: = {socket1,socket2} = {（IP1：port1），（IP2：port2）}**

  3. TCP提供可靠交付的服务：无差错、不丢失、不重复、按序到达

  4. 提供全双工通信：并且两端都设有缓存

  5. 面向字节流：TCP可能调整数据块长度

* 连续ARQ（自动重传请求协议）

* 首部格式（最小20字节）：

  **源端口2 目的端口2 序号4 确认号4 数据偏移4 保留6 **

  控制位：**紧急URG 确认ACK 推送PSH 复位RST 同步SYN 终止FIN**

  **窗口2 检验和2 紧急指针2 选项**

  序号：本报文段所发送的数据的第一个字节的序号（唯一） 

  确认号：期望收到对方下一个报文段的第一个数据字节的序号

  数据偏移：数据起始处距报文段起始处有多远（即**首部长度**）

  URG=1：紧急，配合紧急指针使用ee；ACK=0：确认号无效；PSH立即响应，不攒缓存；RST重置连接；连接请求；释放连接

  窗口：作为接收方让发送方设置其发送窗口的依据



#### 滑动窗口

以字节为单位

* 通过”滑动窗口“实现流量控制：持续计时器

  窗口的大小由接收方给出



## UDP协议

## 中间件

### Redis

1. ***Redis可以用来做什么？***

   1. Redis最常用来做缓存，是实现分布式缓存的首选中间件
   2. Redis可以作为数据库，实现诸如点赞、关注、排行等对性能要求极高的互联网需求
   3. Redis可以作为计算工具，能用很小的代价，统计诸如PV/UV、用户在线天数等数据
   4. 其他使用场景，例如：可以实现分布式锁、可以作为消息队列使用

2. ***Redis与传统的关系型数据库有什么不同？***

   * 基于键值对的NoSQL数据库，而键值对的值是由多种数据结构和算法组成的
   * 数据都存储于内存中，速度惊人，读写性能可达到10万/秒，远超关系型数据库

3. ***Redis有哪些数据类型？***

   1. 5种核心数据类型：字符串、哈希、列表、集合、有序集合
   2. 还基于上述核心数据类型实现了Bitmap、HyperLogLog、Geo类型
   3. 5.0新增了Streams数据类型，它是一个功能强大的、支持多播的、可持久化的消息队列

4. ***Redis是单线程的，为什么还能这么快？***

   1. 对于服务器端程序来说，进程切换和锁通常是性能杀手，而单线程避免了进程切换和竞争所产生的消耗

   2. Redis大部分操作是在内存上完成的，这是它实现高性能的一个重要原因

   3. Redis采用IO多路复用机制，使其在网络IO操作中并发处理大量的客户端请求，实现高吞吐率

      > IO多路复用：

5. Redis在持久化时fork出一个子进程，这时已经有两个进程了，怎么能说是单线程呢？

---

### 消息队列

#### 1. MQ有什么用？

1. 异步：

   允许应用把一些消息放入消息中间件中，并不立即处理它

2. 解耦：

   将所需共享的数据放在消息队列中，对于新增业务模块，只要对该类消息感兴趣，即可订阅该类消息，对原有系统和业务没有任何影响，降低了系统各个模块的耦合度，提高了系统的可扩展性。

3. 削峰：

   使用消息队列能够使关键组件支撑突发访问压力，不会因为突发的超负荷请求而完全崩溃。

   无须以少数峰值为标准投放资源，造成不必要的浪费

   消息队列的容量可以配置的很大，如果采用磁盘存储消息，则几乎等于“无限”容量，这样一来，高峰期的消息可以被积压起来，在随后的时间内进行平滑的处理完成，而不至于让系统短时间内无法承载而导致崩溃。

   在电商网站的秒杀抢购这种突发性流量很强的业务场景中，消息队列的强大缓冲能力可以很好的起到削峰作用。

##### 生产者与消费者模式

所谓生产者-消费者问题，实际上主要是包含了两类线程。一种是生产者线程用于生产数据，另一种是消费者线程用于消费数据，为了解耦生产者和消费者的关系，通常会采用共享的数据区域，就像是一个仓库。

生产者生产数据之后直接放置在共享数据区中，并不需要关心消费者的行为。而消费者只需要从共享数据区中去获取数据，就不再需要关心生产者的行为。

但是，这个共享数据区域中应该具备这样的线程间并发协作的功能：

1. 如果共享数据区已满的话，阻塞生产者继续生产数据放置入内；
2. 如果共享数据区为空的话，阻塞消费者继续消费数据。

在Java语言中，实现生产者消费者问题时，可以采用三种方式：

1. 使用 Object 的 wait/notify 的消息通知机制；
2. 使用 Lock 的 Condition 的 await/signal 的消息通知机制；
3. 使用 BlockingQueue 实现。

#### 2. 如何保证顺序消费？

#### 3. 如何保证消息不丢

#### 4. 如何保证不重复消费？

#### 5. 处理消息失败了怎么办？



---

### 搜索引擎

> Elasticsearch
>
> 实时、分布式、搜索、分析
>
> - Elasticsearch对模糊搜索非常擅长（搜索速度很快）
> - 从Elasticsearch搜索到的数据可以根据**评分**过滤掉大部分的，只要返回评分高的给用户就好了（原生就支持排序）
> - 没有那么准确的关键字也能搜出相关的结果（能匹配有相关性的记录）
>
> 

